let products= [
    {
    "id": 1,
    "title": "kachu",
    "price": 1,
    "description": "A descriptionhhuhu",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T07:54:25.000Z",
    "updatedAt": "2023-06-21T10:49:16.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 2,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:12.000Z",
    "updatedAt": "2023-06-21T08:21:12.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 3,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:13.000Z",
    "updatedAt": "2023-06-21T08:21:13.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 4,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:15.000Z",
    "updatedAt": "2023-06-21T08:21:15.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 5,
    "title": "New Product",
    "price": 102798,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:17.000Z",
    "updatedAt": "2023-06-21T10:40:32.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 6,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:18.000Z",
    "updatedAt": "2023-06-21T08:21:18.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 7,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:26.000Z",
    "updatedAt": "2023-06-21T08:21:26.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 8,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:31.000Z",
    "updatedAt": "2023-06-21T08:21:31.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 9,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:34.000Z",
    "updatedAt": "2023-06-21T08:21:34.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 10,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:36.000Z",
    "updatedAt": "2023-06-21T08:21:36.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 11,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:39.000Z",
    "updatedAt": "2023-06-21T08:21:39.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 12,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:41.000Z",
    "updatedAt": "2023-06-21T08:21:41.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 13,
    "title": "Change title",
    "price": 57,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:44.000Z",
    "updatedAt": "2023-06-21T14:59:33.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 14,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:46.000Z",
    "updatedAt": "2023-06-21T08:21:46.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 15,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:48.000Z",
    "updatedAt": "2023-06-21T08:21:48.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 16,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T08:21:50.000Z",
    "updatedAt": "2023-06-21T08:21:50.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 17,
    "title": "New Product 291",
    "price": 291,
    "description": "A description",
    "images": [
    "https://w7.pngwing.com/pngs/895/199/png-transparent-spider-man-heroes-download-with-transparent-background-free-thumbnail.png"
    ],
    "creationAt": "2023-06-21T08:40:01.000Z",
    "updatedAt": "2023-06-21T08:57:30.000Z",
    "category": {
    "id": 2,
    "name": "Electronics",
    "image": "https://picsum.photos/640/640?r=8421",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 18,
    "title": "chhota",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T09:40:18.000Z",
    "updatedAt": "2023-06-21T09:40:18.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 19,
    "title": "come on daddy",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T09:41:43.000Z",
    "updatedAt": "2023-06-21T09:41:43.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 20,
    "title": "zalo",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T09:58:48.000Z",
    "updatedAt": "2023-06-21T09:58:48.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 21,
    "title": "Another title",
    "price": 14000,
    "description": "Boring",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T10:10:32.000Z",
    "updatedAt": "2023-06-21T12:23:43.000Z",
    "category": {
    "id": 2,
    "name": "Electronics",
    "image": "https://picsum.photos/640/640?r=8421",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 22,
    "title": "Hello im a new produc",
    "price": 999999,
    "description": "I love you uwu",
    "images": [
    "https://estaticos-cdn.prensaiberica.es/clip/823f515c-8143-4044-8f13-85ea1ef58f3a_16-9-discover-aspect-ratio_default_0.jpg"
    ],
    "creationAt": "2023-06-21T13:27:08.000Z",
    "updatedAt": "2023-06-21T13:27:08.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 23,
    "title": "297",
    "price": 297,
    "description": "I love you uwu",
    "images": [
    "https://estaticos-cdn.prensaiberica.es/clip/823f515c-8143-4044-8f13-85ea1ef58f3a_16-9-discover-aspect-ratio_default_0.jpg"
    ],
    "creationAt": "2023-06-21T13:37:17.000Z",
    "updatedAt": "2023-06-21T13:37:17.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 24,
    "title": "New Product",
    "price": 10,
    "description": "A description",
    "images": [
    "https://placeimg.com/640/480/any"
    ],
    "creationAt": "2023-06-21T14:38:46.000Z",
    "updatedAt": "2023-06-21T14:38:46.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 25,
    "title":"fdgh",
    "price": 1,
    "description": "dfh",
    "images": [
    "https://picsum.photos/640/640?r=6408"
    ],
    "creationAt": "2023-06-21T15:30:25.000Z",
    "updatedAt": "2023-06-21T15:30:25.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    },
    {
    "id": 26,
    "title": "7547",
    "price": 6571,
    "description": "6757",
    "images": [
    "https://picsum.photos/640/640?r=6408"
    ],
    "creationAt": "2023-06-21T15:32:36.000Z",
    "updatedAt": "2023-06-21T15:32:36.000Z",
    "category": {
    "id": 1,
    "name": "Clothes",
    "image": "https://picsum.photos/640/640?r=4763",
    "creationAt": "2023-06-21T06:37:02.000Z",
    "updatedAt": "2023-06-21T06:37:02.000Z"
    }
    }
    ]

export const getAllProducts= (req, res)=>{
    const data= products

    if(req.query.offset)
    {
        let offset= req.query.offset * 1
        let limit= req.query.limit * 1
        if(offset === 0){
            limit+=1
        }
        const limitedProducts= data.filter((obj)=> obj.id >= offset && obj.id < (limit+offset))
       return res.status(200).json({
            status: 'success',
            length: limitedProducts.length,
            products: limitedProducts
        })
    }
    if(!data) return res.status(404).json({
        message: 'There is no products'
    })
    console.log(products)
    res.status(200).json({
        status: 'success',
        length: data.length,
        products
    })
}

export const getOne= (req, res)=>{
    const product= products.find((item) => item.id ===req.params.id*1)

    if(!product) return res.status(401).json({
        message: 'The Product with given id is not found'
    })

    res.status(200).json({
        status: 'success',
        product
    })
}

export const addProduct= (req, res)=>{
    const {title, price, description, categoryId, images}= req.body

    if(!title || !price || !description || !categoryId || !images) return res.status(401).json({
        message: "missing element"
    })

    const product= products.find((item)=> item.category.id === categoryId)
    if(!product) return res.status(201).json({
        message: "there is no category with given categoryId"
    })
    const newObj= {id: products.length + 1,
         title,
         price,
         description,
         categoryId,
         images,
         category: product.category,
         creationAt: Date.now(),
         updatedAt: Date.now()
        }

        products.push(newObj)

        res.status(201).json({
            status: 'success',
            product: newObj
        })
}

export const updateProduct= (req, res)=>{

    const product= products.find((item) => item.id ===req.params.id*1)

    if(!product) return res.status(404).json({
        message: "There is no item with given id"
    })

    const updatedObj = req.body; // Update the age and city properties

    const index = products.findIndex((obj) => obj.id ===req.params.id*1 ); // Find the index of the object with the specified id

if (index !== -1) {
  products[index] = Object.assign({}, products[index], updatedObj); // Merge the original object with the updated object
}

const newProduct= products.find((item)=> item.id ===req.params.id*1)
console.log(products)
res.status(201).json({
    status:'success',
    product: newProduct
})
}

export const deleteProduct= (req, res)=>{
    const product= products.find((item) => item.id ===req.params.id*1)

    if(!product) return res.status(404).json({
        message: "There is no item with given id"
    })

    products=products.filter((obj)=> obj.id !== req.params.id*1)

    res.status(200).send(true)
    console.log(products)
}